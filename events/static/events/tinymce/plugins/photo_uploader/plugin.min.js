var progressUpdate=function(o,t,e,n){console.log(o,t,e,n)},success=function(o){var t=tinymce.activeEditor;for(var e in o)t.selection.setContent('<img title="'+e+'" src="/'+o[e]+'" />');setTimeout(function(){t.execCommand("mceAutoResize"),console.log("resized")},50)},ajaxFormOptions={dataType:"json",uploadProgress:progressUpdate,success:success},upload_photo=function(){$("#photo_uploader").ajaxSubmit(ajaxFormOptions)};$("#photos").change(upload_photo),tinymce.PluginManager.add("photo_uploader",function(o){o.addButton("photo_uploader",{title:"Insert photo",icon:"image",onclick:function(){$("#photos").click()}})});